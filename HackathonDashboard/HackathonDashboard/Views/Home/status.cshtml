<!DOCTYPE html>
<html>
<head>
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="Content/normalize.css" />
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.2.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="Style/demo.css" />
    <link rel="stylesheet" type="text/css" href="Style/set1.css" />
    <link rel="stylesheet" type="text/css" href="Style/statusBody.css" />

    <title>SignalR Simple Chat</title>
</head>
<body>
    <div class="container">
        <div id="header">
            <!--<input type="text" id="message"/>
            <input type="button" id="sendmessage" value="Send"/>-->
            <span class="input input--juro">
                <input class="input__field input__field--juro" type="text" id="message" />
                <label class="input__label input__label--juro" for="input-28">
                    <span class="input__label-content input__label-content--juro">Write Something..</span>
                </label>
            </span>
            <input type="button" id="sendmessage" value="Send" />
            <input type="hidden" id="displayname" />
        </div>
        <div id="body">
            <div id="discussion"></div>

        </div>
    </div>
    <!--Script references. -->
    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-1.6.4.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <!--Add script to update the page and send messages.-->
    <script type="text/javascript">
    $(function() {
        // Declare a proxy to reference the hub.
        debugger;
        var chat = $.connection.chatHub;
        // Create a function that the hub can call to broadcast messages.
        chat.client.broadcastMessage = function(name, message) {
            // Html encode display name and message.
            var encodedName = $('<div />').text(name).html();
            var encodedMsg = $('<div />').text(message).html();
            // Add the message to the page.
            //$('#discussion').append('<div id="postDiv"><strong>' + encodedName
            //    + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</div>');
            //document.getElementById("userName").innerHTML = encodedName + " says, ";
            //document.getElementById("statusBody").innerHTML = encodedMsg;

            $('#discussion').prepend("<div class='box6'><h1>" + encodedName + " says, </h1><img src='http://www.wpthemegenerator.com/wp-content/uploads/2012/06/Image.jpg'><p>" + encodedMsg + "</p><br /><div class='box6_corner_lf'></div> <div class='box6_corner_rt'></div></div>");

        };
        // Get the user name and store it to prepend to messages.
        $('#displayname').val(prompt('Enter your name:', ''));
        // Set initial focus to message input box.
        $('#message').focus();
        // Start the connection.
        $.connection.hub.start().done(function() {
            $('#sendmessage').click(function() {
                // Call the Send method on the hub.
                chat.server.send($('#displayname').val(), $('#message').val());
                // Clear text box and reset focus for next comment.
                $('#message').val('').focus();
            });
        });
    });
    </script>

    <script src="Scripts/classie.js"></script>
    <script>
    (function () {
        // trim polyfill : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim
        if (!String.prototype.trim) {
            (function () {
                // Make sure we trim BOM and NBSP
                var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
                String.prototype.trim = function () {
                    return this.replace(rtrim, '');
                };
            })();
        }

        [].slice.call(document.querySelectorAll('input.input__field')).forEach(function (inputEl) {
            // in case the input is already filled..
            if (inputEl.value.trim() !== '') {
                classie.add(inputEl.parentNode, 'input--filled');
            }

            // events:
            inputEl.addEventListener('focus', onInputFocus);
            inputEl.addEventListener('blur', onInputBlur);
        });

        function onInputFocus(ev) {
            classie.add(ev.target.parentNode, 'input--filled');
        }

        function onInputBlur(ev) {
            if (ev.target.value.trim() === '') {
                classie.remove(ev.target.parentNode, 'input--filled');
            }
        }
    })();
    </script>
</body>
</html>
